'use strict';

const Application = require('castv2-client').Application;
const BrowserController = require('./BrowserController');

const Browser = class Browser extends Application {
	constructor(client, session) {
		super(client, session);

		BrowserController.APP_URN = Browser.APP_URN;

		const onDisconnect = () => {
			this.emit('close');
		}

		const onClose = () => {
			this.browser.removeListener('disconnect', onDisconnect);
			this.browser.close();
			this.browser = null;
		}

		this.browser = this.createController(BrowserController);
		this.browser.once('disconnect', onDisconnect);
		this.once('close', onClose);
	}

	redirect(url, options, callback) {
		this.browser.redirect(url, options, callback);
	}
}

Browser.APP_ID = '909CFFC5';
Browser.APP_URN = 'com.athom.chromecast';

module.exports = Browser;
